[
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list SL items with WIP amount\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 2\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show budget vs actual comparison for job phases Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 1\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is ARInvoice structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARInvoice' does not exist in Viewpoint Vista.\n\nUse ARTH (AR Transaction Header) for AR invoices.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get AP invoices not yet fully paid\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 50\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to find all unpaid AR invoices older than 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find job-related AP invoices Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show subcontract invoices and AP payment detail Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for ClientMaster?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ClientMaster' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for client/customer information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show subcontract summary with CO, invoiced and paid amounts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 5\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from JCJM for analysis\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List jobs by status Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 1\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list all customers with contact information\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve customer addresses and contacts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show subcontract invoices and AP payment detail\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 10\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show subcontract summary with CO, invoiced and paid amounts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list jobs exceeding their budget Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to analyze job profitability with revenue and cost\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to identify jobs running over budget with cost to complete Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM Employee\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Employee' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in WorkOrders\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'WorkOrders' does not exist in Viewpoint Vista.\n\nUse SMWorkOrder for service management work orders.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SMWorkOrder WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in TimeCards\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimeCards' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list all vendors with payment terms Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will create aging buckets for outstanding AR invoices Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to summarize receivables by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for Invoices?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Invoices' does not exist in Viewpoint Vista.\n\nFor AR invoices, use ARTH (AR Transaction Header). For AP invoices, use APTH (AP Transaction Header).\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get cost detail by cost type for a job\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 100\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list AP invoices by vendor with discount and retainage amounts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show budget vs actual comparison for job phases Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 1\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to calculate job revenue recognition with billing and cost\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP invoices currently on hold\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 10\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get vendor invoice totals with discounts and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get customer aging analysis for accounts receivable\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List active jobs with status and dates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to calculate job revenue recognition with billing and cost Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show subcontract summary with CO, invoiced and paid amounts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 10\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to calculate subcontract totals with all components Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 2\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM Projects\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Projects' does not exist in Viewpoint Vista.\n\nUse JCJM (JC Job Master) for project information. Vista calls projects 'Jobs'.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find job-related AP invoices Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list invoice header and details for a specific customer Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show all active jobs\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get SL invoices with AP payment status Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get complete subcontract cost breakdown Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 5\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to identify jobs running over budget with cost to complete Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show AP transactions with payment hold status Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 100\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to calculate materials purchased but not installed Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list overdue AR invoices past 60 days\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get invoice details with line items for a customer Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 5\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get customer aging analysis for accounts receivable Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show vendor invoices with job cost detail Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get customer aging analysis for accounts receivable Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query PREH along with the schema tables\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me retrieve vendor addresses and payment terms\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show outstanding AR transactions over 60 days\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 50\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show outstanding AR transactions over 60 days\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the ChangeOrder table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChangeOrder' does not exist in Viewpoint Vista.\n\nUse JCOI (JC Change Order Item) for change order details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCOI WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me retrieve job list with start and end dates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show subcontract stored materials balance Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show subcontract summary with CO, invoiced and paid amounts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD\nINNER JOIN SLIT ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 2\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to calculate total invoices per vendor with discount and retainage detail Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AR balances summarized by customer group Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show budget vs actual comparison for job phases Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me retrieve full invoice information including all lines\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list all vendors with payment terms\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get SL invoices with AP payment status\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show outstanding vendor invoices pending payment Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get subcontract payment status from AP\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 1\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show AP transactions with payment hold status\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 100\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will generate an AR aging summary grouped by customer Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show subcontract summary with CO, invoiced and paid amounts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD\nINNER JOIN SLIT ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list AR balances summarized by customer group Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list all job cost entries with cost type breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 2\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to calculate total AR balance per customer group\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get complete subcontract cost breakdown Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will calculate stored materials (Purchased - Installed) for SL billing Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 2\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show budget vs actual comparison for job phases Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 5\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get AP invoices not yet fully paid Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get customer master list with phone and email Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show vendor details with payment information Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list unpaid AP invoices awaiting payment\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 10\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list unpaid invoices categorized by age (30/60/90 days) Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 2\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get AR invoices by job with contract details Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 100\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get detailed job cost transactions by cost type Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get subcontractor costs with original, change orders, invoiced, paid, and retainage Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Analyze job profitability with revenue and cost\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get invoice details with line items for a customer Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 5\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get held vendor invoices with hold codes\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 5\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List AR customers with full details\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list SL costs including change orders and retainage\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 50\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Analyze job profitability with revenue and cost\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get AR transactions with job reference Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list AP invoices currently on hold\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 2\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show vendor details with payment information\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get SL invoices with AP payment status Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get AP invoices not yet fully paid\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find jobs over budget with remaining cost projection Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 100\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get job master list with project details Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 1\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get cost detail by cost type for a job Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 100\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve invoices blocked from payment with reason Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 1\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in SubcontractHeader\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SubcontractHeader' does not exist in Viewpoint Vista.\n\nUse SLHD (SL Header) for subcontract headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me calculate cost variance between budget and actual by job phase Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 5\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate job revenue recognition with billing and cost Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list SL items with WIP amount Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate earned revenue by job Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will calculate materials purchased but not installed Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 5\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list AP vendors with full details Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show customer invoices linked to jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will calculate total invoices per vendor with discount and retainage detail Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 50\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show customer invoices linked to jobs\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me summarize receivables by customer group\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 50\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get SL work in progress for billing purposes\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all job cost entries with cost type breakdown Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list AR billing by job and contract Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get complete invoice data with breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list SL costs including change orders and retainage Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 5\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list all job cost entries with cost type breakdown\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 5\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Retrieve invoices blocked from payment with reason\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list invoice header and details for a specific customer Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show customer balances grouped by customer group Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to retrieve customer addresses and contacts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list active jobs with status and dates Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 2\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show job cost detail grouped by cost type Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 1\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show customer balances grouped by customer group Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list jobs exceeding their budget Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 50\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to calculate job revenue recognition with billing and cost Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Identify jobs running over budget with cost to complete Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 5\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get AR invoices that are more than 60 days old and unpaid Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list AP invoices by vendor with discount and retainage amounts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate materials purchased but not installed\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show customer contact details Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list invoice header and details for a specific customer Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 100\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to find SL invoices matched to AP payments\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 10\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show customer balances grouped by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list unpaid invoices categorized by age (30/60/90 days) Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to calculate earned revenue by job\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get customer master list with phone and email Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will calculate stored materials (Purchased - Installed) for SL billing Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get AR invoices by job with contract details Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH\nLEFT JOIN JCCM ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will retrieve customer addresses and contacts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all vendors with payment terms Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show AR aging report with 30, 60, 90+ day buckets Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to calculate stored materials (Purchased - Installed) for SL billing Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get AR invoices by job with contract details\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get SL invoices with AP payment status Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 1\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to create aging buckets for outstanding AR invoices Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve AP transactions with open balance Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve customer addresses and contacts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include JCJM in the query\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show subcontract invoices and AP payment detail Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 100\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List jobs by status Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to retrieve invoices blocked from payment with reason\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get job cost variance by phase comparing budget to actual Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  -- ... 7 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get AR invoices that are more than 60 days old and unpaid Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find SL invoices matched to AP payments Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 5\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show detailed invoice breakdown with line items Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find invoices on hold with hold reason\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 100\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get customer master list with phone and email Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list invoice header and details for a specific customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 10\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me calculate total invoices per vendor with discount and retainage detail Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 50\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me retrieve JC transactions by labor, material, equipment\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will retrieve vendor addresses and payment terms Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get customer balance summary by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list AP vendors with full details Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list SL costs including change orders and retainage Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to find job-related AP invoices Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 10\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list jobs by status\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to generate an AR aging summary grouped by customer Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list SL billing with AP transaction links\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get detailed job cost transactions by cost type\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 50\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get revenue recognition status for jobs\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get cost detail by cost type for a job Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get revenue recognition status for jobs Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to calculate total AR balance per customer group\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show subcontract summary with CO, invoiced and paid amounts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD\nINNER JOIN SLIT ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get AP invoices distributed to jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find all unpaid AR invoices older than 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM Vendor\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Vendor' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to calculate materials purchased but not installed\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM Subcontracts\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Subcontracts' does not exist in Viewpoint Vista.\n\nUse SLHD (SL Header) for subcontract headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get customer aging analysis for accounts receivable Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will retrieve past-due invoices exceeding 60 days Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get revenue recognition status for jobs Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list SL costs including change orders and retainage\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get SL invoices with AP payment status Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 1\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all job cost entries with cost type breakdown\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 5\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ChartOfAccounts\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChartOfAccounts' does not exist in Viewpoint Vista.\n\nUse GLAC (GL Account) for chart of accounts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer master list with phone and email\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Retrieve invoices blocked from payment with reason\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List AR customers with full details Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to find open AP invoices pending payment Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the Employees table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Employees' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list unpaid invoices categorized by age (30/60/90 days) Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list active jobs with status and dates Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = 5\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me retrieve job list with start and end dates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 10\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List AR customers with full details\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get AR invoices that are more than 60 days old and unpaid Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get complete subcontract cost breakdown\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 100\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show vendor invoices including discounts taken and retainage held Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  -- ... 97 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list all job cost entries with cost type breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 5\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to calculate stored materials (Purchased - Installed) for SL billing Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to identify jobs running over budget with cost to complete Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the ChangeOrders table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChangeOrders' does not exist in Viewpoint Vista.\n\nUse JCOI (JC Change Order Item) for change order details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCOI WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list SL billing with AP transaction links Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 1\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join JCJM with the available tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get held vendor invoices with hold codes Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show customer balances grouped by customer group Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to calculate total AR balance per customer group Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get AR invoices by job with contract details Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show customer contact details Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP invoices by vendor with discount and retainage amounts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to find all unpaid AR invoices older than 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve invoices blocked from payment with reason Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 2\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate total invoices per vendor with discount and retainage detail Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find invoices associated with contracts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get over-budget jobs with projected final cost Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 100\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to calculate stored materials (Purchased - Installed) for SL billing Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list SL costs including change orders and retainage\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show outstanding vendor invoices pending payment\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 2\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show all active jobs\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 2\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join SLHD with the available tables\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get AP invoices linked to job costs\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 10\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list active jobs with status and dates Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = 100\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list jobs by status Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find open AP invoices pending payment Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show detailed invoice breakdown with line items\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 5\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 1\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find SL invoices matched to AP payments Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 1\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get vendor invoice totals with discounts and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 2\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list AP invoices currently on hold Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate total invoices per vendor with discount and retainage detail Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show subcontract invoices and AP payment detail Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get SL invoices with AP payment status Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 5\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will retrieve customer addresses and contacts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to retrieve job list with start and end dates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get customer aging analysis for accounts receivable Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show AP transactions with payment hold status Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 50\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show outstanding AR transactions over 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will calculate total invoices per vendor with discount and retainage detail Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find open AP invoices pending payment Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 2\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for Companies?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Companies' does not exist in Viewpoint Vista.\n\nUse HQCO (HQ Company) for company information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM HQCO WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will retrieve job list with start and end dates\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 2\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to analyze job profitability with revenue and cost Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 5\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list SL items with WIP amount\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 100\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list AR billing by job and contract Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH\nLEFT JOIN JCCM ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 2\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to calculate total invoices per vendor with discount and retainage detail Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get complete invoice data with breakdown\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 2\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get invoice details with line items for a customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 1\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list SL billing with AP transaction links Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get subcontract payment status from AP Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me find all unpaid AR invoices older than 60 days Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from Employees\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Employees' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show customer contact details Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get vendor invoice totals with discounts and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  -- ... 97 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 50\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get AR transactions with job reference Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to retrieve full invoice information including all lines Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 50\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list all job cost entries with cost type breakdown Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 10\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me summarize receivables by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to create aging buckets for outstanding AR invoices Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list AP invoices by vendor with discount and retainage amounts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get revenue recognition status for jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 10\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is Jobs structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Jobs' does not exist in Viewpoint Vista.\n\nUse JCJM (JC Job Master) for job/project information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list AP invoices currently on hold Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 50\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show job cost detail grouped by cost type Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 10\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to calculate total AR balance per customer group Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join ARCM with the available tables\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to compare estimated to actual costs for each job phase Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 50\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me retrieve customer addresses and contacts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to calculate stored materials (Purchased - Installed) for SL billing Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate total AR balance per customer group\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list SL costs including change orders and retainage Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me find SL invoices matched to AP payments\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show outstanding AR transactions over 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will retrieve AP transactions with open balance Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get vendor master list with terms\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list jobs by status Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to find invoices on hold with hold reason Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 5\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find jobs over budget with remaining cost projection Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 50\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find job-related AP invoices Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list overdue AR invoices past 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to find invoices on hold with hold reason Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 100\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get detailed job cost transactions by cost type Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 1\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List SL items with WIP amount Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate cost variance between budget and actual by job phase Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  -- ... 7 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 1\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show budget vs actual comparison for job phases Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate stored materials (Purchased - Installed) for SL billing Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 2\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show detailed invoice breakdown with line items Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list invoice header and details for a specific customer Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 2\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from GLDT for analysis\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list AR customers with full details Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list active jobs with status and dates\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will summarize AP invoices by vendor with discount and retainage breakdown\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate total invoices per vendor with discount and retainage detail Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the Contracts table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Contracts' does not exist in Viewpoint Vista.\n\nUse JCCM (JC Contract Master) for contract information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get customer balance summary by customer group Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to retrieve AP transactions with open balance\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve vendor addresses and payment terms\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find SL invoices matched to AP payments Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 10\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the ARAgingReport table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARAgingReport' does not exist in Viewpoint Vista.\n\nUse ARTH (AR Transaction Header) with DATEDIFF calculations for aging. There is no pre-built ARAgingReport table in Vista.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get SL work in progress for billing purposes\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 1\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show all active jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = 5\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to analyze job cost overruns and underruns by phase Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 50\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to find SL invoices matched to AP payments\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 100\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get job master list with project details\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 5\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get invoice details with line items for a customer Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join GLDT with the available tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to generate an AR aging summary grouped by customer Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 50\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from ARCM for analysis\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show budget vs actual comparison for job phases\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 2\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Retrieve customer addresses and contacts\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to find job-related AP invoices Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query SLHD along with the schema tables\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show vendor invoices including discounts taken and retainage held\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  -- ... 97 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show outstanding AR transactions over 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is CostCodes structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'CostCodes' does not exist in Viewpoint Vista.\n\nUse JCCP (JC Cost Phase) for cost code/phase information with cost details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list SL billing with AP transaction links\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 1\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join Retainage with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Retainage' does not exist in Viewpoint Vista.\n\nRetainage is stored in APTD (PayType column) for AP and SLWI (WCRetAmt, SMRetAmt) for subcontracts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to retrieve AP transactions with open balance\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get job cost variance by phase comparing budget to actual Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get held vendor invoices with hold codes\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job master list with project details Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = 10\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show AP transactions with payment hold status Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 2\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get held vendor invoices with hold codes\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get revenue recognition status for jobs\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get invoice details with line items for a customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to retrieve invoices blocked from payment with reason Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 100\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to find invoices on hold with hold reason Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get AR invoices that are more than 60 days old and unpaid Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to analyze job cost overruns and underruns by phase Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find invoices associated with contracts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 2\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show outstanding AR transactions over 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get over-budget jobs with projected final cost Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 2\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list AR customers with full details Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get AR transactions with job reference Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find SL invoices matched to AP payments Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list unpaid invoices categorized by age (30/60/90 days) Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Retrieve job list with start and end dates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 2\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AR balances summarized by customer group\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate materials purchased but not installed Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list invoice header and details for a specific customer Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 10\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show vendor invoices including discounts taken and retainage held\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get complete subcontract cost breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list all job cost entries with cost type breakdown Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 2\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show job cost detail grouped by cost type Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 1\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate an AR aging summary grouped by customer Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get subcontract payment status from AP Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list SL items with WIP amount Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 10\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from Vendor\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Vendor' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list all vendors with payment terms Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get AR invoices by job with contract details\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me calculate stored materials (Purchased - Installed) for SL billing Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 2\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get SL invoices with AP payment status Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find jobs over budget with remaining cost projection Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list AR customers with full details\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get vendor invoice totals with discounts and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list active jobs with status and dates\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 5\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the Transactions table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Transactions' does not exist in Viewpoint Vista.\n\nUse GLDT (GL Detail) for GL transactions, or module-specific tables like APTH, ARTH, JCCD.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show subcontract summary with CO, invoiced and paid amounts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show jobs where actual costs exceed estimates\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get SL work in progress for billing purposes Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get invoice details with line items for a customer Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me retrieve invoices blocked from payment with reason Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to generate an AR aging summary grouped by customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to calculate total invoices per vendor with discount and retainage detail Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list AP transactions tied to JC\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 50\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to find job-related AP invoices Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP transactions tied to JC Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get revenue recognition status for jobs Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to retrieve full invoice information including all lines Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to calculate cost variance between budget and actual by job phase Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  -- ... 7 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 100\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get AR invoices that are more than 60 days old and unpaid Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find open AP invoices pending payment\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show vendor details with payment information Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show subcontract summary with CO, invoiced and paid amounts\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List unpaid AP invoices awaiting payment Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list unpaid invoices categorized by age (30/60/90 days) Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show customer invoices linked to jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH\nLEFT JOIN JCCM ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 100\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in ARInvoice\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARInvoice' does not exist in Viewpoint Vista.\n\nUse ARTH (AR Transaction Header) for AR invoices.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to find open AP invoices pending payment Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get complete subcontract cost breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD\nINNER JOIN SLIT ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 1\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show vendor details with payment information\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list SL items with WIP amount\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show AR aging report with 30, 60, 90+ day buckets\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get revenue recognition status for jobs Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 2\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list invoice header and details for a specific customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query ChartOfAccounts\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChartOfAccounts' does not exist in Viewpoint Vista.\n\nUse GLAC (GL Account) for chart of accounts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show AP transactions with payment hold status Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 1\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list AR balances summarized by customer group\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show subcontract invoices and AP payment detail Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show outstanding vendor invoices pending payment Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show customer contact details Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include PREH in the query\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show all active jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 1\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show customer invoices linked to jobs Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show job cost detail grouped by cost type Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP invoices by vendor with discount and retainage amounts\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to find invoices on hold with hold reason Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP vendors with full details Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list all job cost entries with cost type breakdown Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 10\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to calculate job revenue recognition with billing and cost Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 5\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List SL billing with AP transaction links Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get SL invoices with AP payment status Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 10\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will generate an AR aging summary grouped by customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List overdue AR invoices past 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get AP invoices distributed to jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM Retainage\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Retainage' does not exist in Viewpoint Vista.\n\nRetainage is stored in APTD (PayType column) for AP and SLWI (WCRetAmt, SMRetAmt) for subcontracts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join PREH with the available tables\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find all unpaid AR invoices older than 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 2\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show job cost detail grouped by cost type Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show vendor details with payment information\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show customer invoices linked to jobs Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 2\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get job master list with project details Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = 1\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show customer contact details\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list overdue AR invoices past 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list SL costs including change orders and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD\nINNER JOIN SLIT ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 50\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate materials purchased but not installed\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 100\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get AR invoices by job with contract details Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list SL costs including change orders and retainage Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 50\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get vendor invoice totals with discounts and retainage Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list AP transactions tied to JC\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show outstanding AR transactions over 60 days Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get customer balance summary by customer group Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show subcontract stored materials balance Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show outstanding AR transactions over 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list jobs exceeding their budget Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will generate an AR aging summary grouped by customer Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get vendor invoice totals with discounts and retainage Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show job cost detail grouped by cost type Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 100\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show subcontract stored materials balance\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve customer addresses and contacts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list jobs by status Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = 50\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show vendor invoices with job cost detail Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to analyze job cost overruns and underruns by phase Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show outstanding AR transactions over 60 days Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list active jobs with status and dates\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 2\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show vendor details with payment information\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show jobs where actual costs exceed estimates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 100\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list AR balances summarized by customer group Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show outstanding AR transactions over 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me retrieve past-due invoices exceeding 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 2\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP invoices currently on hold Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get vendor invoice totals with discounts and retainage Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  -- ... 97 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list jobs exceeding their budget Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get SL invoices with AP payment status Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get SL invoices with AP payment status Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list all customers with contact information\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show customer balances grouped by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list overdue AR invoices past 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list AR balances summarized by customer group Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list SL costs including change orders and retainage Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show jobs where actual costs exceed estimates Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show subcontract summary with CO, invoiced and paid amounts\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me create aging buckets for outstanding AR invoices Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 2\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show AP transactions with payment hold status Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 5\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show customer balances grouped by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to retrieve vendor addresses and payment terms Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get AR invoices that are more than 60 days old and unpaid Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the EmployeeMaster table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'EmployeeMaster' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee master information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show AR aging report with 30, 60, 90+ day buckets Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 2\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get held vendor invoices with hold codes Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get revenue recognition status for jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 5\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for ContractMaster?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ContractMaster' does not exist in Viewpoint Vista.\n\nUse JCCM (JC Contract Master) for contract master information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me find invoices associated with contracts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 2\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get customer master list with phone and email\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show job billing vs cost for revenue analysis\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list unpaid AP invoices awaiting payment Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the Phases table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Phases' does not exist in Viewpoint Vista.\n\nUse JCJP (JC Job Phase) for phase definitions.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get AR invoices that are more than 60 days old and unpaid Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list SL billing with AP transaction links Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include GLDT in the query\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get SL invoices with AP payment status Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 100\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to retrieve vendor addresses and payment terms Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show job billing vs cost for revenue analysis\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to find invoices associated with contracts\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP invoices by vendor with discount and retainage amounts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get detailed job cost transactions by cost type\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 1\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find invoices associated with contracts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is Accounts structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Accounts' does not exist in Viewpoint Vista.\n\nUse GLAC (GL Account) for chart of accounts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve JC transactions by labor, material, equipment Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to find job-related AP invoices\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to retrieve full invoice information including all lines Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 1\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to retrieve full invoice information including all lines Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 2\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP vendors with full details\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from Contracts\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Contracts' does not exist in Viewpoint Vista.\n\nUse JCCM (JC Contract Master) for contract information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list AR balances summarized by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get SL invoices with AP payment status Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 100\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the Accounts table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Accounts' does not exist in Viewpoint Vista.\n\nUse GLAC (GL Account) for chart of accounts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in APInvoice\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'APInvoice' does not exist in Viewpoint Vista.\n\nUse APTH (AP Transaction Header) for AP invoices.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Retrieve job list with start and end dates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List AP transactions tied to JC\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get over-budget jobs with projected final cost\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 50\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the Departments table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Departments' does not exist in Viewpoint Vista.\n\nUse JCDP (JC Department) for department information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCDP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get cost detail by cost type for a job\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 2\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find job-related AP invoices Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show outstanding vendor invoices pending payment Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to retrieve vendor addresses and payment terms Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get complete subcontract cost breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 5\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to retrieve customer addresses and contacts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query GLDT along with the schema tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get AP invoices not yet fully paid Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 50\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list AP invoices currently on hold Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 2\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list invoice header and details for a specific customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 5\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to retrieve AP transactions with open balance Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to analyze job profitability with revenue and cost Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 1\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is APInvoice structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'APInvoice' does not exist in Viewpoint Vista.\n\nUse APTH (AP Transaction Header) for AP invoices.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show outstanding AR transactions over 60 days Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get complete invoice data with breakdown Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List unpaid invoices categorized by age (30/60/90 days) Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show subcontract invoices and AP payment detail Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLTransactions\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLTransactions' does not exist in Viewpoint Vista.\n\nUse GLDT (GL Detail) for GL transaction details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for Customers?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Customers' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for customer information. Vista uses abbreviated table names.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find SL invoices matched to AP payments Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP invoices currently on hold Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 1\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to retrieve invoices blocked from payment with reason Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 10\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list jobs exceeding their budget Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 1\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get customer balance summary by customer group Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to calculate total AR balance per customer group Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get job cost variance by phase comparing budget to actual Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is Projects structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Projects' does not exist in Viewpoint Vista.\n\nUse JCJM (JC Job Master) for project information. Vista calls projects 'Jobs'.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query CostCodes\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'CostCodes' does not exist in Viewpoint Vista.\n\nUse JCCP (JC Cost Phase) for cost code/phase information with cost details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to find jobs over budget with remaining cost projection Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 100\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find SL invoices matched to AP payments Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 1\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list SL items with WIP amount Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 5\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me find invoices associated with contracts\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 2\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list overdue AR invoices past 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 50\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show subcontract summary with CO, invoiced and paid amounts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get AR invoices by job with contract details Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH\nLEFT JOIN JCCM ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me calculate total invoices per vendor with discount and retainage detail Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get AP invoices distributed to jobs Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show vendor details with payment information Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get detailed job cost transactions by cost type Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve customer addresses and contacts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show budget vs actual comparison for job phases Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  -- ... 7 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 2\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show customer invoices linked to jobs Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH\nLEFT JOIN JCCM ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will create aging buckets for outstanding AR invoices Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query Invoices\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Invoices' does not exist in Viewpoint Vista.\n\nFor AR invoices, use ARTH (AR Transaction Header). For AP invoices, use APTH (AP Transaction Header).\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show job billing vs cost for revenue analysis\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 2\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to find invoices on hold with hold reason\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 100\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list all vendors with payment terms Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to identify jobs running over budget with cost to complete Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me calculate cost variance between budget and actual by job phase\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 5\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show job billing vs cost for revenue analysis\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show job billing vs cost for revenue analysis Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from VendorMaster\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'VendorMaster' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get over-budget jobs with projected final cost Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM EmployeeMaster\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'EmployeeMaster' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee master information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list AP invoices currently on hold Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 100\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list jobs exceeding their budget Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 100\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to calculate materials purchased but not installed\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to retrieve invoices blocked from payment with reason Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 100\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from PREH for analysis\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list unpaid invoices categorized by age (30/60/90 days) Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get customer master list with phone and email Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show subcontract summary with CO, invoiced and paid amounts Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 1\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP transactions tied to JC Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list jobs exceeding their budget\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show budget vs actual comparison for job phases\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  -- ... 7 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 2\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list SL costs including change orders and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 2\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get AR invoices that are more than 60 days old and unpaid Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show subcontract invoices and AP payment detail Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 10\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list unpaid AP invoices awaiting payment Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list SL billing with AP transaction links Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 2\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find open AP invoices pending payment Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get invoice details with line items for a customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 10\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to analyze job cost overruns and underruns by phase\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get AR transactions with job reference Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH\nLEFT JOIN JCCM ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get cost detail by cost type for a job\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 2\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show AP transactions with payment hold status Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 2\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me calculate total invoices per vendor with discount and retainage detail\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in Departments\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Departments' does not exist in Viewpoint Vista.\n\nUse JCDP (JC Department) for department information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCDP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get AP invoices linked to job costs\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 5\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list all vendors with payment terms Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list SL billing with AP transaction links Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 50\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the Phases table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Phases' does not exist in Viewpoint Vista.\n\nUse JCJP (JC Job Phase) for phase definitions.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get AR invoices by job with contract details Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get job cost variance by phase comparing budget to actual Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 50\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get job cost variance by phase comparing budget to actual Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get AR invoices by job with contract details Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List jobs exceeding their budget Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to calculate materials purchased but not installed\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 5\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to analyze job profitability with revenue and cost Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the Customers table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Customers' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for customer information. Vista uses abbreviated table names.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find invoices associated with contracts\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH\nLEFT JOIN JCCM ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show all active jobs Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = 1\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show job cost detail grouped by cost type Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to retrieve full invoice information including all lines Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get complete subcontract cost breakdown Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list AR customers with full details Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to calculate cost variance between budget and actual by job phase Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show AP transactions with payment hold status Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get job master list with project details\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate job revenue recognition with billing and cost Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 5\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get vendor invoice totals with discounts and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will retrieve invoices blocked from payment with reason Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get vendor invoice totals with discounts and retainage Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to retrieve AP transactions with open balance\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to find jobs over budget with remaining cost projection Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 2\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list unpaid invoices categorized by age (30/60/90 days) Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list unpaid invoices categorized by age (30/60/90 days) Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show AR aging report with 30, 60, 90+ day buckets Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List AP invoices currently on hold Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show all active jobs\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 5\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list AP invoices by vendor with discount and retainage amounts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list AR customers with full details Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join GLTransactions with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLTransactions' does not exist in Viewpoint Vista.\n\nUse GLDT (GL Detail) for GL transaction details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list all vendors with payment terms Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will compare estimated to actual costs for each job phase\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query ARCM along with the schema tables\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find job-related AP invoices Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get AR invoices that are more than 60 days old and unpaid Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 100\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List SL costs including change orders and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list AP invoices currently on hold Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include SLHD in the query\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me show customer balances grouped by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show customer contact details\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query TimeCard\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimeCard' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show customer balances grouped by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find job-related AP invoices Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show vendor invoices including discounts taken and retainage held Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list AP vendors with full details\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to calculate stored materials (Purchased - Installed) for SL billing Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 2\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will calculate job revenue recognition with billing and cost\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show subcontract summary with CO, invoiced and paid amounts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD\nINNER JOIN SLIT ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show customer balances grouped by customer group\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list active jobs with status and dates Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get complete invoice data with breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me retrieve full invoice information including all lines Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me create aging buckets for outstanding AR invoices Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 50\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query JCJM along with the schema tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list AP invoices currently on hold Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to calculate subcontract totals with all components Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 1\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get revenue recognition status for jobs Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the TimecardHeader table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimecardHeader' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list all customers with contact information\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get SL invoices with AP payment status\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 10\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me calculate total AR balance per customer group Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get invoice details with line items for a customer Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to calculate total AR balance per customer group Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 50\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get SL work in progress for billing purposes Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show outstanding AR transactions over 60 days\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get complete invoice data with breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 50\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will retrieve job list with start and end dates\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 100\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to create aging buckets for outstanding AR invoices Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get revenue recognition status for jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show subcontract stored materials balance Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list job phases with budget variance analysis\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will generate an AR aging summary grouped by customer Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me analyze job cost overruns and underruns by phase Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list job phases with budget variance analysis\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list all vendors with payment terms Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list AP invoices currently on hold Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 1\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AP invoices by vendor with discount and retainage amounts\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  -- ... 97 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list all job cost entries with cost type breakdown\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 50\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get AP invoices not yet fully paid Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get AR invoices that are more than 60 days old and unpaid Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show vendor invoices including discounts taken and retainage held Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me calculate cost variance between budget and actual by job phase Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list jobs exceeding their budget Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 5\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get complete subcontract cost breakdown Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 10\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get invoice details with line items for a customer Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list AR billing by job and contract Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to generate an AR aging summary grouped by customer Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query SubcontractHeader\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SubcontractHeader' does not exist in Viewpoint Vista.\n\nUse SLHD (SL Header) for subcontract headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List SL billing with AP transaction links\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = 50\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to summarize receivables by customer group\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = 2\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list AR billing by job and contract Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH\nLEFT JOIN JCCM ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for Employee?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Employee' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to retrieve full invoice information including all lines Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 5\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show subcontract summary with CO, invoiced and paid amounts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in Transactions\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Transactions' does not exist in Viewpoint Vista.\n\nUse GLDT (GL Detail) for GL transactions, or module-specific tables like APTH, ARTH, JCCD.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get over-budget jobs with projected final cost Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 2\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join Companies with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Companies' does not exist in Viewpoint Vista.\n\nUse HQCO (HQ Company) for company information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM HQCO WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to retrieve past-due invoices exceeding 60 days Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get held vendor invoices with hold codes Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show vendor invoices with job cost detail Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show vendor invoices with job cost detail\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join ChangeOrder with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChangeOrder' does not exist in Viewpoint Vista.\n\nUse JCOI (JC Change Order Item) for change order details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCOI WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get complete invoice data with breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 10\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list active jobs with status and dates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show subcontract stored materials balance Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 5\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 100\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show AR aging report with 30, 60, 90+ day buckets Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get AR transactions with job reference Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Analyze job profitability with revenue and cost Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list AP transactions tied to JC Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to calculate job revenue recognition with billing and cost Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 10\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list jobs exceeding their budget Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 5\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list AR balances summarized by customer group\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get AP invoices not yet fully paid Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list SL items with WIP amount Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 10\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get subcontractor costs with original, change orders, invoiced, paid, and retainage\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 10\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list all job cost entries with cost type breakdown Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get vendor invoice totals with discounts and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show customer balances grouped by customer group Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show subcontract summary with CO, invoiced and paid amounts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = @SLCo\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate cost variance between budget and actual by job phase Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 1\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me calculate total invoices per vendor with discount and retainage detail Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the Customer table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Customer' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for customer information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show outstanding vendor invoices pending payment Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get subcontractor costs with original, change orders, invoiced, paid, and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 1\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show vendor details with payment information Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to calculate cost variance between budget and actual by job phase Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get cost detail by cost type for a job\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will calculate stored materials (Purchased - Installed) for SL billing Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to retrieve JC transactions by labor, material, equipment Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 100\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get SL work in progress for billing purposes Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to calculate earned revenue by job Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 2\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 1\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list all vendors with payment terms Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get complete invoice data with breakdown Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 10\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to find invoices associated with contracts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list overdue AR invoices past 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  -- ... 35 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get SL work in progress for billing purposes Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 50\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show job billing vs cost for revenue analysis\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get AR invoices by job with contract details Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to summarize AP invoices by vendor with discount and retainage breakdown\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get AP invoices not yet fully paid Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get complete invoice data with breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 50\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list all vendors with payment terms Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in Vendors\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Vendors' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information. Vista uses abbreviated table names.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list AP invoices currently on hold Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get vendor invoice totals with discounts and retainage Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM TimecardHeader\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimecardHeader' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find SL invoices matched to AP payments\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to generate an AR aging summary grouped by customer Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get SL invoices with AP payment status\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show outstanding AR transactions over 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to retrieve AP transactions with open balance Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get invoice details with line items for a customer Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to retrieve job list with start and end dates Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = 10\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show subcontract stored materials balance\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will find open AP invoices pending payment Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to summarize AP invoices by vendor with discount and retainage breakdown\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get AR invoices that are more than 60 days old and unpaid\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the WorkOrders table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'WorkOrders' does not exist in Viewpoint Vista.\n\nUse SMWorkOrder for service management work orders.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SMWorkOrder WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get complete invoice data with breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 10\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to find invoices associated with contracts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  -- ... 56 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to summarize AP invoices by vendor with discount and retainage breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  -- ... 97 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 1\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get customer aging analysis for accounts receivable Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list job phases with budget variance analysis Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 50\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the Subcontracts table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Subcontracts' does not exist in Viewpoint Vista.\n\nUse SLHD (SL Header) for subcontract headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to find all unpaid AR invoices older than 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show job cost detail grouped by cost type Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 10\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get SL invoices with AP payment status\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI\nINNER JOIN APTL ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list all vendors with payment terms\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include ARCM in the query\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list AR billing by job and contract\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show all active jobs Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 1\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Retrieve vendor addresses and payment terms\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get AR invoices that are more than 60 days old and unpaid Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from Payments\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Payments' does not exist in Viewpoint Vista.\n\nFor AP payments, use APTD (AP Transaction Detail). For AR payments, use ARTH with appropriate ARTransType.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get SL work in progress for billing purposes Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 50\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show subcontract stored materials balance Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI\nINNER JOIN SLIT ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 1\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show job cost detail grouped by cost type\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 50\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to find invoices associated with contracts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 1\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to retrieve invoices blocked from payment with reason Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 2\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to find job-related AP invoices\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show customer contact details Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get AR transactions with job reference\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH\nLEFT JOIN JCCM ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will summarize AP invoices by vendor with discount and retainage breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  OverridePayType byn NOT NULL,\n  RetHoldCode bholdcode,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  CMInterfaceLvl tinyint NOT NULL,\n  -- ... 87 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get AR invoices that are more than 60 days old and unpaid Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show customer contact details Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to calculate job revenue recognition with billing and cost\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 100\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List jobs by status\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = 2\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get complete invoice data with breakdown Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get customer balance summary by customer group Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in ClientMaster\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ClientMaster' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for client/customer information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find SL invoices matched to AP payments Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get AP invoices not yet fully paid\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get held vendor invoices with hold codes\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = 1\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate subcontract totals with all components Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD\nINNER JOIN SLIT ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 100\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from SLHD for analysis\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show subcontract stored materials balance Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  -- ... 33 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 1\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show vendor invoices with job cost detail Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show outstanding AR transactions over 60 days Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  -- ... 61 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  -- ... 40 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve customer addresses and contacts\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join VendorMaster with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'VendorMaster' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get customer master list with phone and email Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show outstanding AR transactions over 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get vendor master list with terms Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Retrieve job list with start and end dates Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 5\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to retrieve full invoice information including all lines\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 100\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get revenue recognition status for jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 100\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get AP invoices distributed to jobs\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get AR transactions with job reference Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 5\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get AP invoices linked to job costs Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to analyze job profitability with revenue and cost Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 10\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get cost detail by cost type for a job Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 50\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get complete invoice data with breakdown Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 100\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get job cost variance by phase comparing budget to actual Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  -- ... 7 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 1\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list all job cost entries with cost type breakdown\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get AP invoices distributed to jobs\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me find job-related AP invoices Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show all active jobs Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list AP transactions tied to JC Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 5\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to calculate cost variance between budget and actual by job phase Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  -- ... 14 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  -- ... 7 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 100\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get customer master list with phone and email\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list jobs exceeding their budget Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 10\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list SL billing with AP transaction links Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get cost detail by cost type for a job Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 1\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to retrieve customer addresses and contacts Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get cost detail by cost type for a job Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 100\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me get job cost variance by phase comparing budget to actual Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = 50\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will retrieve JC transactions by labor, material, equipment Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 50\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to compare estimated to actual costs for each job phase Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list AP invoices currently on hold Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to calculate total invoices per vendor with discount and retainage detail Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  -- ... 97 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get vendor invoice totals with discounts and retainage:\n1. Join APTH (transactions) with APVM (vendors) on VendorGroup and Vendor\n2. Sum GrossAmt for total invoiced\n3. Include DiscTaken and Retainage columns\n4. Calculate net as gross minus discounts minus retainage\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(*) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS TotalGross,\n  SUM(APTH.DiscTaken) AS TotalDiscounts,\n  SUM(APTH.Retainage) AS TotalRetainage,\n  SUM(APTH.GrossAmt - ISNULL(APTH.DiscTaken, 0) - ISNULL(APTH.Retainage, 0)) AS NetPayable\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 100\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY TotalGross DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate cost variance between budget and actual by job phase Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me find jobs over budget with remaining cost projection Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM\nINNER JOIN JCCP ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 50\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = 10\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list AP transactions tied to JC Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from Vendors\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Vendors' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information. Vista uses abbreviated table names.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to get AP invoices linked to job costs\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join Locations with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Locations' does not exist in Viewpoint Vista.\n\nUse HQLC (HQ Location) for location information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM HQLC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to analyze job profitability with revenue and cost Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 50\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show detailed invoice breakdown with line items Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to retrieve customer addresses and contacts\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list customers with contact info:\n1. Query ARCM for customer master data\n2. Include Phone, Email, Contact fields\n3. Include Address fields\n4. Filter by CustGroup if needed\n\n```sql\nSELECT \n  CustGroup,\n  Customer,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  Contact,\n  Address,\n  City,\n  State,\n  Zip\nFROM ARCM WITH (NOLOCK)\nWHERE CustGroup = @CustGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to find invoices associated with contracts Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nLEFT JOIN JCCM WITH (NOLOCK) ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show job cost detail grouped by cost type Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to show subcontract stored materials balance Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 2\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to show AR aging report with 30, 60, 90+ day buckets Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Join ARTH (AR transactions) with ARCM (customers) on CustGroup and Customer\n2. Filter to unpaid invoices using PayFullDate IS NULL\n3. Use DATEDIFF with CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show detailed invoice breakdown with line items Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 5\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get subcontract payment status from AP\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list SL billing with AP transaction links Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to list AP transactions tied to JC\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to calculate stored materials (Purchased - Installed) for SL billing Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 2\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show customer invoices linked to jobs\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AR invoices by job/contract:\n1. Query ARTH for invoice data\n2. Join JCCM for contract description\n3. Include ARCM for customer name\n4. Filter where Contract IS NOT NULL\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  ARTH.Contract,\n  JCCM.Description AS ContractDesc,\n  ARCM.Name AS CustomerName\nFROM ARTH\nLEFT JOIN JCCM ON ARTH.JCCo = JCCM.JCCo AND ARTH.Contract = JCCM.Contract\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Contract IS NOT NULL\nORDER BY ARTH.TransDate DESC\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "JCCM",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will list unpaid AP invoices awaiting payment Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = 50\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to get AP invoices linked to job costs\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH WITH (NOLOCK)\nINNER JOIN APTD WITH (NOLOCK) ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query ContractMaster\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ContractMaster' does not exist in Viewpoint Vista.\n\nUse JCCM (JC Contract Master) for contract master information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me retrieve vendor addresses and payment terms Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is TimeCard structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimeCard' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get SL work in progress for billing purposes Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to list active jobs with status and dates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 10\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to list all job cost entries with cost type breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 1\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me list all job cost entries with cost type breakdown Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 1\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to list invoice header and details for a specific customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get cost detail by cost type for a job\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  -- ... 90 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD\nINNER JOIN JCJP ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = 1\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list SL items with WIP amount Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  OrigUnitCost bunitcost NOT NULL,\n  OrigCost bdollar NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  -- ... 23 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate stored materials for SL billing:\n1. Query SLWI for work item details\n2. Join SLIT for item description\n3. Sum GrossAmt (purchased) and InstalledAmt\n4. Stored materials = Purchased - Installed\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description,\n  SUM(SLWI.GrossAmt) AS PurchasedAmt,\n  SUM(SLWI.InstalledAmt) AS InstalledAmt,\n  SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) AS StoredMaterials\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = 100\nGROUP BY SLWI.SLCo, SLWI.SL, SLWI.SLItem, SLIT.Description\nHAVING SUM(SLWI.GrossAmt) - SUM(SLWI.InstalledAmt) > 0\nORDER BY StoredMaterials DESC\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to retrieve vendor addresses and payment terms Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to show subcontract summary with CO, invoiced and paid amounts\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get subcontract cost breakdown:\n1. Join SLHD (header) with SLIT (items) on SLCo and SL\n2. Sum OrigCost for original contract\n3. Calculate change orders as CurCost - OrigCost\n4. Include InvCost, PaidCost, and Retainage\n\n```sql\nSELECT \n  SLHD.SLCo,\n  SLHD.SL AS Subcontract,\n  SLHD.Description AS SubcontractDesc,\n  SLHD.Vendor,\n  SUM(SLIT.OrigCost) AS OriginalAmount,\n  SUM(SLIT.CurCost) - SUM(SLIT.OrigCost) AS ChangeOrders,\n  SUM(SLIT.CurCost) AS CurrentAmount,\n  SUM(SLIT.InvCost) AS InvoicedAmount,\n  SUM(SLIT.PaidCost) AS PaidAmount,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost) - SUM(SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nWHERE SLHD.SLCo = 50\nGROUP BY SLHD.SLCo, SLHD.SL, SLHD.Description, SLHD.Vendor\nORDER BY SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to get job cost variance by phase comparing budget to actual Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to show AP transactions with payment hold status\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD WITH (NOLOCK) ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to find all unpaid AR invoices older than 60 days Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARCO (\n  ARCo bcompany NOT NULL,\n  GLCo bcompany,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMInterface tinyint NOT NULL,\n  CMSummaryDesc varchar(30),\n  JCCo bcompany,\n  JCInterface tinyint NOT NULL,\n  FCLevel tinyint NOT NULL,\n  FCCalcOnFC byn NOT NULL,\n  FCPct bpct NOT NULL,\n  FCMinChrg bdollar NOT NULL,\n  FCMinBal bdollar NOT NULL,\n  FCFinOrServ char(1),\n  FCRecType tinyint,\n  GLInvLev tinyint,\n  InvoiceJrnl bjrnl,\n  GLInvSummaryDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLPayLev tinyint,\n  PaymentJrnl bjrnl,\n  GLPaySummaryDesc varchar(60),\n  GLPayDetailDesc varchar(60),\n  GLMiscCashLev tinyint,\n  MiscCashJrnl bjrnl,\n  -- ... 30 more columns,\n  PRIMARY KEY (ARCo, KeyID)\n);\n\nCREATE TABLE JCCM (\n  JCCo bcompany,\n  Contract bcontract NOT NULL,\n  Description bitemdesc,\n  Department bdept NOT NULL,\n  ContractStatus tinyint NOT NULL,\n  OriginalDays smallint NOT NULL,\n  CurrentDays smallint NOT NULL,\n  StartMonth bmonth NOT NULL,\n  MonthClosed bmonth,\n  ProjCloseDate bdate,\n  ActualCloseDate bdate,\n  CustGroup bgroup,\n  Customer bcustomer,\n  PayTerms bpayterms,\n  TaxInterface byn NOT NULL,\n  TaxGroup bgroup,\n  TaxCode btaxcode,\n  RetainagePCT bpct NOT NULL,\n  DefaultBillType bbilltype NOT NULL,\n  OrigContractAmt bdollar NOT NULL,\n  ContractAmt bdollar NOT NULL,\n  BilledAmt bdollar NOT NULL,\n  ReceivedAmt bdollar NOT NULL,\n  CurrentRetainAmt bdollar NOT NULL,\n  InBatchMth bmonth,\n  -- ... 51 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid AR invoices older than 60 days:\n1. Query ARTH for transaction details, join ARCM for customer name\n2. Filter PayFullDate IS NULL for unpaid invoices\n3. Use DATEDIFF to calculate days outstanding\n4. Filter where days > 60\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding,\n  ARCM.Name AS CustomerName\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY DaysOutstanding DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List SL billing with AP transaction links\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  Installed bdollar NOT NULL,\n  SMRetPct bpct NOT NULL,\n  SMRetAmt bdollar NOT NULL,\n  LineDesc bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  -- ... 12 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  CostCode bcostcode,\n  EMCType bemctype,\n  CompType varchar(10),\n  Component bequip,\n  INCo bcompany,\n  -- ... 51 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  Supplier bvendor,\n  PayCategory int,\n  KeyID bigint NOT NULL,\n  GSTtaxAmt bdollar,\n  TotTaxAmount bdollar,\n  -- ... 8 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  PrePaidChk bcmref,\n  PrePaidSeq tinyint,\n  PrePaidProcYN byn NOT NULL,\n  V1099YN byn NOT NULL,\n  V1099Type varchar(10),\n  -- ... 36 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  OrigDate bdate,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  SLCloseBatchID bbatchid,\n  MaxRetgOpt char(1) NOT NULL,\n  -- ... 10 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need SQL to retrieve job list with start and end dates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to list SL billing with AP transaction links Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  -- ... 22 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  -- ... 61 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  -- ... 18 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  -- ... 20 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get SL invoices with AP payment status:\n1. Start from SLWI (work items)\n2. Join APTL to link SL to AP transactions\n3. Join APTD for payment details\n4. Calculate open amount as GrossAmt - PaidAmt\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  APTL.APCo,\n  APTL.Mth,\n  APTL.APTrans,\n  APTL.APLine,\n  APTD.GrossAmt,\n  APTD.PaidAmt,\n  APTD.GrossAmt - ISNULL(APTD.PaidAmt, 0) AS OpenAmt\nFROM SLWI WITH (NOLOCK)\nINNER JOIN APTL WITH (NOLOCK) ON SLWI.SLCo = APTL.SLCo AND SLWI.SL = APTL.SL AND SLWI.SLItem = APTL.SLItem\nINNER JOIN APTD WITH (NOLOCK) ON APTL.APCo = APTD.APCo AND APTL.Mth = APTD.Mth AND APTL.APTrans = APTD.APTrans AND APTL.APLine = APTD.APLine\nWHERE SLWI.SLCo = @SLCo\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "APTL",
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show all active jobs Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  -- ... 69 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = 100\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Retrieve full invoice information including all lines Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  CMDeposit bcmref,\n  CreditAmt bdollar NOT NULL,\n  PayTerms bpayterms,\n  -- ... 18 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  BillAddress2 varchar(60),\n  Status char(1) NOT NULL,\n  RecType tinyint,\n  PayTerms bpayterms,\n  TaxGroup bgroup,\n  -- ... 30 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI WITH (NOLOCK) ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = 50\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in Customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Customer' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for customer information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Help me find invoices on hold with hold reason Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find invoices on hold:\n1. Query APTH filtered where HoldCode IS NOT NULL\n2. Join APVM for vendor name\n3. Join APHD for hold code description\n4. Useful for reviewing blocked payments\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.GrossAmt,\n  APTH.HoldCode,\n  APHD.Description AS HoldReason\nFROM APTH\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nLEFT JOIN APHD ON APTH.APCo = APHD.APCo AND APTH.HoldCode = APHD.HoldCode\nWHERE APTH.APCo = @APCo\n  AND APTH.HoldCode IS NOT NULL\nORDER BY APVM.Name, APTH.InvDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM",
        "APHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the TimeCards table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimeCards' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show outstanding vendor invoices pending payment\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  -- ... 46 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 88 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find open AP invoices:\n1. Query APTH for invoice details, join APVM for vendor name\n2. Filter by Status < 3 (not fully paid) or where GrossAmt > AmtPaid\n3. Calculate open balance as GrossAmt minus AmtPaid\n4. Include DaysPastDue for prioritization\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.Mth,\n  APTH.APTrans,\n  APVM.Name AS VendorName,\n  APTH.APRef,\n  APTH.InvDate,\n  APTH.DueDate,\n  APTH.GrossAmt,\n  APTH.AmtPaid,\n  APTH.GrossAmt - ISNULL(APTH.AmtPaid, 0) AS OpenBalance,\n  DATEDIFF(day, APTH.DueDate, GETDATE()) AS DaysPastDue\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTH.Status < 3  -- Not fully paid\n  AND APTH.GrossAmt > ISNULL(APTH.AmtPaid, 0)\nORDER BY APTH.DueDate\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Can you write SQL to get AP invoices distributed to jobs Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get AP invoices linked to job costs:\n1. Join APTH (header) with APTD (detail) for distributions\n2. Filter where APTD.Job IS NOT NULL\n3. Include APVM for vendor name\n4. Shows job cost impact of AP invoices\n\n```sql\nSELECT \n  APTH.APCo,\n  APTH.APRef,\n  APTH.InvDate,\n  APTD.Job,\n  APTD.Phase,\n  APTD.CostType,\n  APTD.GrossAmt AS DistributedAmt,\n  APVM.Name AS VendorName\nFROM APTH\nINNER JOIN APTD ON APTH.APCo = APTD.APCo AND APTH.Mth = APTD.Mth AND APTH.APTrans = APTD.APTrans\nINNER JOIN APVM ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\n  AND APTD.Job IS NOT NULL\nORDER BY APTH.InvDate DESC, APTD.Job\n```",
    "metadata": {
      "category": "cross_module",
      "complexity": "advanced",
      "tables_used": [
        "APTH",
        "APTD",
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to summarize receivables by customer group Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get customer balance by customer group:\n1. Sum amounts from ARTH grouped by CustGroup\n2. Use ARTransType to separate invoices ('I') from payments ('P')\n3. Calculate net balance as total of all transactions\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.ARTransType = 'I' THEN ARTH.Amount ELSE 0 END) AS TotalInvoiced,\n  SUM(CASE WHEN ARTH.ARTransType = 'P' THEN ARTH.Amount ELSE 0 END) AS TotalPayments,\n  SUM(ARTH.Amount) AS NetBalance\nFROM ARTH WITH (NOLOCK)\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARTH.CustGroup\nORDER BY ARTH.CustGroup\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List active jobs with status and dates Use Vista best practices.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  LiabTemplate smallint,\n  TaxGroup bgroup NOT NULL,\n  TaxCode btaxcode,\n  InsTemplate smallint,\n  MarkUpDiscRate brate NOT NULL,\n  -- ... 59 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list active jobs:\n1. Query JCJM for job master data\n2. Filter JobStatus = 1 for active jobs\n3. Include key dates and project manager\n4. Optionally include Contract reference\n\n```sql\nSELECT \n  JCCo,\n  Job,\n  Description,\n  Contract,\n  JobStatus,\n  StartDate,\n  ProjectedCloseDate,\n  ActualCloseDate,\n  BidDate,\n  ProjectMgr\nFROM JCJM WITH (NOLOCK)\nWHERE JCCo = @JCCo\n  AND JobStatus = 1  -- Active\nORDER BY Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will analyze job profitability with revenue and cost Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate job revenue recognition:\n1. Join JCJM with JCCP for cost and billing data\n2. Sum ActualCost for costs incurred\n3. Sum BilledAmt for amounts billed\n4. Calculate percent complete for revenue recognition\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description,\n  JCJM.Contract,\n  SUM(JCCP.OrigEstCost) AS TotalBudgetCost,\n  SUM(JCCP.ActualCost) AS TotalActualCost,\n  SUM(JCCP.BilledAmt) AS TotalBilled,\n  SUM(JCCP.ActualCost) - SUM(JCCP.BilledAmt) AS UnbilledCost,\n  CASE \n    WHEN SUM(JCCP.OrigEstCost) = 0 THEN 0\n    ELSE SUM(JCCP.ActualCost) / SUM(JCCP.OrigEstCost) * 100 \n  END AS PctComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 50\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description, JCJM.Contract\nORDER BY JCJM.Job\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show me how to get job cost variance by phase comparing budget to actual Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  ForecastCost bdollar NOT NULL,\n  TotalCmtdUnits bunits NOT NULL,\n  TotalCmtdCost bdollar NOT NULL,\n  RemainCmtdUnits bunits NOT NULL,\n  RemainCmtdCost bdollar NOT NULL,\n  -- ... 4 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost variance by phase:\n1. Join JCJP (job phases) with JCCP (cost projections) on JCCo, Job, Phase\n2. Compare OrigEstCost (budget) to ActualCost\n3. Calculate variance as budget minus actual\n4. Include percentage variance for analysis\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCJP.Description AS PhaseDescription,\n  JCCP.OrigEstCost AS BudgetCost,\n  JCCP.ActualCost,\n  JCCP.OrigEstCost - JCCP.ActualCost AS CostVariance,\n  CASE \n    WHEN JCCP.OrigEstCost = 0 THEN 0\n    ELSE (JCCP.ActualCost - JCCP.OrigEstCost) / JCCP.OrigEstCost * 100 \n  END AS VariancePct\nFROM JCJP\nINNER JOIN JCCP ON JCJP.JCCo = JCCP.JCCo AND JCJP.Job = JCCP.Job AND JCJP.Phase = JCCP.Phase\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write a SQL query to show job cost detail grouped by cost type\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  PerECM becm,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  ProgressCmplt bpct NOT NULL,\n  -- ... 80 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get job cost detail by cost type:\n1. Query JCCD for cost detail records\n2. Join JCCT for cost type descriptions\n3. Group by phase and cost type\n4. Sum ActualCost and ActualUnits\n\n```sql\nSELECT \n  JCCD.JCCo,\n  JCCD.Job,\n  JCCD.Phase,\n  JCCD.CostType,\n  JCCT.Description AS CostTypeDesc,\n  SUM(JCCD.ActualCost) AS TotalCost,\n  SUM(JCCD.ActualUnits) AS TotalUnits,\n  COUNT(*) AS TransactionCount\nFROM JCCD WITH (NOLOCK)\nINNER JOIN JCJP WITH (NOLOCK) ON JCCD.JCCo = JCJP.JCCo AND JCCD.Job = JCJP.Job AND JCCD.Phase = JCJP.Phase\nLEFT JOIN JCCT WITH (NOLOCK) ON JCCD.JCCo = JCCT.JCCo AND JCCD.CostType = JCCT.CostType\nWHERE JCCD.JCCo = @JCCo\n  AND JCCD.Job = @Job\nGROUP BY JCCD.JCCo, JCCD.Job, JCCD.Phase, JCCD.CostType, JCCT.Description\nORDER BY JCCD.Phase, JCCD.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD",
        "JCJP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is Locations structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Locations' does not exist in Viewpoint Vista.\n\nUse HQLC (HQ Location) for location information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM HQLC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will get over-budget jobs with projected final cost\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find jobs over budget:\n1. Join JCJM (job master) with JCCP (cost projections)\n2. Sum OrigEstCost for budget, ActualCost for spent\n3. Use HAVING to filter where actual exceeds budget\n4. Include ProjCost for final cost projection\n\n```sql\nSELECT \n  JCJM.JCCo,\n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  SUM(JCCP.OrigEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.RemainCmtdCost) AS RemainingCommitted,\n  SUM(JCCP.ProjCost) AS ProjectedFinal,\n  SUM(JCCP.ProjCost) - SUM(JCCP.OrigEstCost) AS ProjectedOverrun\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = 100\n  AND JCJM.JobStatus = 1  -- Active jobs\nGROUP BY JCJM.JCCo, JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.OrigEstCost)\nORDER BY ProjectedOverrun DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query that will show vendor details with payment information Please include all relevant columns.\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  POAddress2 varchar(60),\n  Purge byn NOT NULL,\n  CustGroup bgroup,\n  Customer bcustomer,\n  TaxGroup bgroup,\n  -- ... 78 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To list vendors with payment terms:\n1. Query APVM for vendor master data\n2. Include PayTerms for payment terms\n3. Include contact and address fields\n4. Filter by VendorGroup if needed\n\n```sql\nSELECT \n  VendorGroup,\n  Vendor,\n  Name,\n  SortName,\n  Phone,\n  Fax,\n  EMail,\n  PayTerms,\n  Address,\n  City,\n  State,\n  Zip\nFROM APVM WITH (NOLOCK)\nWHERE VendorGroup = @VendorGroup\nORDER BY Name\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get complete invoice data with breakdown Order results appropriately.\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  -- ... 28 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  -- ... 40 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To get invoice details with line items:\n1. Join ARTH (header) with ARTI (items) on ARCo, Mth, ARTrans\n2. Include ARCM for customer name\n3. Filter by company and optionally by customer\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Invoice,\n  ARTH.TransDate,\n  ARCM.Name AS CustomerName,\n  ARTI.ARLine,\n  ARTI.Description,\n  ARTI.Amount AS LineAmount,\n  ARTH.Amount AS InvoiceTotal\nFROM ARTH\nINNER JOIN ARCM ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nLEFT JOIN ARTI ON ARTH.ARCo = ARTI.ARCo AND ARTH.Mth = ARTI.Mth AND ARTH.ARTrans = ARTI.ARTrans\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.Customer = @Customer\nORDER BY ARTH.TransDate DESC, ARTI.ARLine\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARTI",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for Jobs?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Jobs' does not exist in Viewpoint Vista.\n\nUse JCJM (JC Job Master) for job/project information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  }
]